## 编译/运行方式
多线程： 所有服务在一台机器上运行，编译只会生成一个可执行文件
多进程： 服务可在多台机器上运行，编译会生成多个独立的可执行文件

## chat 服务端架构
1. login 服务程序
2. gate 服务程序
3. 消息处理服务程序（无记录的）
4. 事务处理服务程序（有记录的，会有事件处理的流程记录）
5. user 数据库服务程序
6. log 数据库服务程序

3和4可以在同一个进程或线程内处理

## chat 服务端流程

### 登录
1. 客户端发起登录请求，会将包发到服务端的 login 服务器。
2. login 接收到包并验证包是否正确，然后读取用户名和密码再和数据库内数据进行比对。
3. 如果用户数据正常生成一个key并分配一个客户端id，并给出当前较优的gate服务器ip地
   址和端口返回给客户端。
4. 同时将该key值返回给用户管理服务器，标志一个用户登录成功。
5. 客户端收到该key值时，会断开原来的连接，并连到指定gate服务器上。
6. gate服务器收到包后会，验证key值和客户账号，如果正确就接收该包，并转发到消息处理中心。

note: 以上步骤中如果有验证不通过的，就丢弃该包并断开连接。

### 登出
1. 用户发送登出的消息包给gate服务器，gate转发到消息处理中心。
2. 消息处理中心通知用户管理服务器，该用户登出。
3. 用户管理服务器处理结束，给出结果包到gate服务器，gate服务器将该包发送给用户。
4. 用户收到包后断开连接。